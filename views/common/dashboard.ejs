<%- include("../common/header.ejs") %>
    <%- include("../common/navbar.ejs") %>
        <%- include("../common/sidebar.ejs") %>
            <% if (msg !=='' ) { %>
                <div class="alert alert-success msg"
                    style="position: absolute; z-index: 9999; color:rgb(36, 23, 23); background-color: #e0d1bf; right: 10px; top: 10px;">
                    <span style="font-size: 16px;">
                        <%= msg %>
                    </span>
                </div>
                <% } %>

                    <div class="app-content content">
                        <div class="content-overlay"></div>
                        <div class="header-navbar-shadow"></div>
                        <div class="content-wrapper container-xxl p-0">
                            <div class="content-header row"></div>
                            <div class="content-body">
                            <h1>Dashboard</h1>

                                <div class="row">
                                    <!-- User Card -->
                                    <div class="col-xl-3 col-sm-6 col-12 mb-2 mb-xl-0">
                                        <div class="card">
                                            <div class="card-body">
                                                <a href="/getUserPage">
                                                    <div class="d-flex flex-row">
                                                        <div class="avatar bg-light-primary me-2">
                                                            <div class="avatar-content">
                                                                <i data-feather="users" class="avatar-icon"></i>
                                                            </div>
                                                        </div>
                                                        <div class="my-auto">
                                                            <h4 class="fw-bolder mb-0">
                                                                <%= user%>
                                                            </h4>
                                                            <p class="card-text font-small-3 mb-0">Users</p>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Provider Card -->
                                    <div class="col-xl-3 col-sm-6 col-12 mb-2 mb-xl-0">
                                        <div class="card">
                                            <div class="card-body">
                                                <a href="/getProviderPage">
                                                    <div class="d-flex flex-row">
                                                        <div class="avatar bg-light-info me-2">
                                                            <div class="avatar-content">
                                                                <i data-feather="align-justify" class="avatar-icon"></i>
                                                            </div>
                                                        </div>
                                                        <div class="my-auto">
                                                            <h4 class="fw-bolder mb-0">
                                                                <%= provider%>
                                                            </h4>
                                                            <p class="card-text font-small-3 mb-0">Provider</p>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Booking Card -->
                                    <div class="col-xl-3 col-sm-6 col-12 mb-2 mb-sm-0">
                                        <div class="card">
                                            <div class="card-body">
                                                <a href="/bookingPage">
                                                    <div class="d-flex flex-row">
                                                        <div class="avatar bg-light-danger me-2">
                                                            <div class="avatar-content">
                                                                <i data-feather="book-open" class="avatar-icon"></i>
                                                            </div>
                                                        </div>
                                                        <div class="my-auto">
                                                            <h4 class="fw-bolder mb-0">
                                                                <%= boking%>
                                                            </h4>
                                                            <p class="card-text font-small-3 mb-0">Booking</p>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Category Card -->
                                    <div class="col-xl-3 col-sm-6 col-12 mb-2 mb-sm-0">
                                        <div class="card">
                                            <div class="card-body">
                                                <a href="/getCategoryPage">
                                                    <div class="d-flex flex-row">
                                                        <div class="avatar bg-light-primary me-2">
                                                            <div class="avatar-content">
                                                                <i data-feather="activity" class="avatar-icon"></i>
                                                            </div>
                                                        </div>
                                                        <div class="my-auto">
                                                            <h4 class="fw-bolder mb-0">
                                                                <%= category%>
                                                            </h4>
                                                            <p class="card-text font-small-3 mb-0">Category</p>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-xl-3 col-sm-6 col-12 mb-2 mb-sm-0">
                                        <div class="card">
                                            <div class="card-body">
                                                <a href="/getSubCategoryPage">
                                                    <div class="d-flex flex-row">
                                                        <div class="avatar bg-light-primary me-2">
                                                            <div class="avatar-content">
                                                                <i data-feather="activity" class="avatar-icon"></i>
                                                            </div>
                                                        </div>
                                                        <div class="my-auto">
                                                            <h4 class="fw-bolder mb-0">
                                                                <%= subCategory%>
                                                            </h4>
                                                            <p class="card-text font-small-3 mb-0">SubCategory</p>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div id="pieChart" style="height: 350px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card">
                                            <div class="card-body">
                                                <div id="barChart" style="height: 350px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <%- include("../common/footer.ejs") %>

                        <!-- //////////////////////////ApexChart//////////////////////// -->



                        <link rel="stylesheet"
                            href="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.44.2/apexcharts.min.css"
                            integrity="sha512-qc0GepkUB5ugt8LevOF/K2h2lLGIloDBcWX8yawu/5V8FXSxZLn3NVMZskeEyOhlc6RxKiEj6QpSrlAoL1D3TA=="
                            crossorigin="anonymous" referrerpolicy="no-referrer" />
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.44.2/apexcharts.min.js"
                            integrity="sha512-0C7wVtM3EhVJMUXV6o50mKRgLwKZf+aRws1BhqmNabPNIkGEvyPncYBmXhpl4A3+TdpkY2HFiI3Eyv32uVGo4g=="
                            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

                        <script>
                            const bookCountArr = JSON.parse('<%= JSON.stringify(countBook) %>');
                            const bookmonthArr = JSON.parse('<%= JSON.stringify(monthBook) %>');
                            var options = {
                                series: [{
                                    name: 'Boking',
                                    data: bookCountArr,
                                    // data: [44, 55, 41,23]
                                }],
                                chart: {
                                    height: 300,
                                    type: 'bar',
                                },
                                plotOptions: {
                                    bar: {
                                        borderRadius: 5,
                                        columnWidth: '50%',
                                    }
                                },
                                dataLabels: {
                                    enabled: false
                                },
                                stroke: {
                                    width: 3,
                                    colors: ['var(--bgtheme)']
                                },
                                grid: {
                                    row: {
                                        colors: ['#fff', '#f2f2f2']
                                    }
                                },
                                xaxis: {
                                    title: {
                                        text: 'Months',
                                    },
                                    labels: {
                                        rotate: -45
                                    },
                                    // categories: monthArr,
                                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'June', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'],
                                    tickPlacement: 'on'
                                },
                                yaxis: {
                                    title: {
                                        text: 'Boking',
                                    },
                                },
                                fill: {
                                    type: 'gradient',
                                    toolbar: {
                                        show: false,
                                    },
                                    gradient: {
                                        shade: 'light',
                                        type: "horizontal",
                                        shadeIntensity: 0.25,
                                        // gradientToColors: undefined,
                                        gradientToColors: ['var(--bgtheme)'],
                                        inverseColors: true,
                                        opacityFrom: 0.85,
                                        opacityTo: 0.85,
                                        // stops: [50, 0, 100]
                                        stops: [100]
                                    },
                                }
                            };
                            var book = new ApexCharts(document.querySelector("#barChart"), options);
                            book.render();                  
                        </script>


                        <script>
                            let user = "<%-user%>";
                            let provider = "<%-provider%>";
                            let boking = "<%-boking%>"

                            var options = {
                                series: [parseInt(user), parseInt(provider), parseInt(boking)],
                                chart: {
                                    width: '100%',
                                    type: 'pie',
                                },
                                labels: ["user", "provider", "boking"],
                                plotOptions: {
                                    pie: {
                                        dataLabels: {
                                            offset: 5
                                        }
                                    }
                                },
                                legend: {
                                    show: true,
                                    position: 'right',
                                    offsetY: 50
                                }
                            };
                            var chart = new ApexCharts(document.querySelector("#pieChart"), options);
                            chart.render();
                        </script>

                        <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>